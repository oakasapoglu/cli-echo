# CLI Echo Tool in Chicken Scheme  

A “vibe coding” CLI [`echo`](https://man7.org/linux/man-pages/man1/echo.1.html) tool implemented in **Chicken Scheme**.  

Scheme is a minimalist Lisp dialect, and Chicken Scheme is a variant that **compiles to portable C code**, producing native executables.

This program is written to test **how fast binaries generated by Chicken Scheme can be** compared to native system commands.  

This project started as an experiment to see how fast Chicken Scheme binaries could run compared to native system commands. 
I started experimenting with Chicken Scheme and wanted to see how its compiled binaries would perform compared to native system commands. This led to creation of this project: a small CLI echo tool.

## **Results**

The result: my echo program `cli` is **~170× slower** than the `echo` builtin in my `zsh` shell.

**Standards:**  
The utility conforms to **IEEE Std 1003.1-2001 (“POSIX.1”)**, as amended by Cor. 1-2002.

**System:** macOS 15.6 (April 12, 2003)


The result was somewhat disappointing. I had expected the performance to be only about **5× to 10× slower**, but it turns out to be much worse. I suspect the reason is that Chicken Scheme compiles a more **Lisp-like version of the program** into C rather than directly translating it into highly optimized C code. As a result, even though the binary is native, it cannot match the raw speed of an `echo` function written directly in C. This illustrates the trade-off between **maintaining Lisp semantics** and achieving **maximum execution speed**.

---

## Speed Test Example

The following is a sample output of running the `make speedtest` command
to compare the performance of the Chicken Scheme CLI echo tool versus
the system `echo` command. Tested on **M1 Mac** with **Chicken Scheme 5.4.0**.

1000 iterations
```md
(base) omer@192 cli-echo % ./run-speedtest.sh 1000
Using 1000 iterations for timing.
Supply a numeric argument to change iteration count.

Timing Chicken Scheme echo (./cli) ...

real	0m4.910s
user	0m2.649s
sys	0m1.641s

Timing system echo (echo -e) ...

real	0m0.029s
user	0m0.013s
sys	0m0.016s
```

4000 iterations
``` md
(base) omer@192 cli-echo % ./run-speedtest.sh 4000
Using 4000 iterations for timing.
Supply a numeric argument to change iteration count.

Timing Chicken Scheme echo (./cli) ...

real	0m19.504s
user	0m10.595s
sys	0m6.530s

Timing system echo (echo -e) ...

real	0m0.109s
user	0m0.048s
sys	0m0.060s
```


| Iterations | Chicken Scheme real | System echo real | System beats Chicken |
|------------|---------------------|------------------|----------------------|
| 1000       | 4.910 s             | 0.029 s          | \~169×               |
| 4000       | 19.504 s            | 0.109 s          | \~179×               |

So, our Chicken Scheme CLI echo is ~170× slower than the system echo.

## **Installation**

### Chicken Scheme

Get it here: [CHICKEN Scheme](https://call-cc.org/)

**Tested environment:**  
- macOS M1 (Apple Silicon)  
- Chicken Scheme version 5.4.0  
- Platform: `macosx-unix-clang-arm64`  

> Note: The project has been verified on this setup; other platforms may work but are untested.


The other methods are than macOS are only possibilities for those platforms.
We have not tested those.


In macOS, this can be easier.
- **macOS:**  
```bash
brew install chicken
```

!!! This part is not tested
- **Linux:**  
```bash
sudo apt install chicken-bin
```

!!! This part is not tested
- **Windows:**  
Use [WSL](https://learn.microsoft.com/en-us/windows/wsl/install) or Git Bash, then install Chicken Scheme.  

### Optional Tools

- GNU Coreutils (for `echo`) — most systems already have it  
- Bash or Zsh shell (for test and speed scripts)  
- `make` and `time` (for building and benchmarking)  

- **macOS without Homebrew:** [Install Homebrew](https://brew.sh/)  

---

## **Build and Run**

1. **Build executable:**
```bash
make
```

2. **Run CLI with example:**
```bash
make run
# or directly:
./cli "Hello\nWorld\t!"
```

3. **Run boolean correctness tests:**
```bash
make test
# or directly:
bash run-tests.sh
```

4. **Run speed benchmark:**
```bash
# Preferred: run via script with optional iteration count
# 100 is the default value
bash run-speed.sh 100

# Less flexible: running via Makefile (cannot pass arguments)
make speedtest
```

5. **Clean artifacts:**
```bash
make clean
```

# end
